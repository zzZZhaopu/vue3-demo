# ESLint å®‰è£…å’Œä½¿ç”¨æŒ‡å— ğŸ“–

## ğŸ¯ ä»€ä¹ˆæ˜¯ ESLintï¼Ÿ

ESLint æ˜¯ä¸€ä¸ª**ä»£ç è´¨é‡æ£€æŸ¥å·¥å…·**ï¼ˆLinterï¼‰ï¼Œå°±åƒæ˜¯ä»£ç çš„"è¯­æ³•è€å¸ˆ"ï¼Œå®ƒèƒ½ï¼š

1. âœ… **è‡ªåŠ¨å‘ç°é—®é¢˜**ï¼šæ‰¾å‡ºä»£ç ä¸­çš„é”™è¯¯ã€ä¸è§„èŒƒå†™æ³•
2. ğŸ”§ **è‡ªåŠ¨ä¿®å¤é—®é¢˜**ï¼šå¾ˆå¤šé—®é¢˜å¯ä»¥ä¸€é”®ä¿®å¤
3. ğŸ“ **ç»Ÿä¸€ä»£ç é£æ ¼**ï¼šè®©å›¢é˜Ÿæ‰€æœ‰äººå†™çš„ä»£ç é£æ ¼ä¸€è‡´
4. ğŸ›¡ï¸ **é¢„é˜²Bug**ï¼šåœ¨ç¼–å†™æ—¶å°±å‘ç°æ½œåœ¨é—®é¢˜ï¼Œè€Œä¸æ˜¯è¿è¡Œæ—¶æ‰æŠ¥é”™

## ğŸ“¦ å·²å®‰è£…çš„åŒ…

æˆ‘ä¸ºä½ å®‰è£…äº†ä»¥ä¸‹åŒ…ï¼š

| åŒ…å | ä½œç”¨ | ä¸ºä»€ä¹ˆéœ€è¦ |
|------|------|-----------|
| `eslint` | ESLint æ ¸å¿ƒ | åŸºç¡€æ£€æŸ¥å¼•æ“ |
| `@eslint/js` | JavaScript è§„åˆ™ | æ£€æŸ¥ JS ä»£ç çš„åŸºç¡€è§„åˆ™ |
| `eslint-plugin-vue` | Vue è§„åˆ™ | æ£€æŸ¥ Vue ç»„ä»¶çš„æœ€ä½³å®è·µ |
| `@vue/eslint-config-typescript` | Vue + TS é…ç½® | è®© Vue å’Œ TypeScript å®Œç¾é…åˆ |
| `typescript-eslint` | TypeScript è§„åˆ™ | æ£€æŸ¥ TS ä»£ç çš„ç±»å‹å®‰å…¨ |
| `vue-eslint-parser` | Vue è§£æå™¨ | ç†è§£ Vue æ–‡ä»¶çš„ç»“æ„ |
| `globals` | å…¨å±€å˜é‡å®šä¹‰ | å‘Šè¯‰ ESLint windowã€document ç­‰æ˜¯åˆæ³•çš„ |

## ğŸ“ åˆ›å»ºçš„æ–‡ä»¶

### 1. `eslint.config.js` - ä¸»é…ç½®æ–‡ä»¶

è¿™æ˜¯ ESLint 9+ çš„æ–°é…ç½®æ ¼å¼ï¼ˆFlat Configï¼‰ï¼Œæ¯”æ—§ç‰ˆæœ¬æ›´ç®€å•æ¸…æ™°ï¼š

```javascript
// é…ç½®ç»“æ„
export default [
  { files: [...] },          // è¦æ£€æŸ¥å“ªäº›æ–‡ä»¶
  { ignores: [...] },        // å¿½ç•¥å“ªäº›æ–‡ä»¶
  æ¨èè§„åˆ™é›†åˆ,               // ä½¿ç”¨å®˜æ–¹æ¨èçš„è§„åˆ™
  è‡ªå®šä¹‰è§„åˆ™                  // æ ¹æ®é¡¹ç›®éœ€æ±‚è°ƒæ•´
]
```

**ä¸»è¦é…ç½®è¯´æ˜**ï¼š

- âœ… **æ£€æŸ¥èŒƒå›´**ï¼šæ‰€æœ‰ `.js`ã€`.ts`ã€`.vue` æ–‡ä»¶
- ğŸš« **å¿½ç•¥æ–‡ä»¶**ï¼š`dist`ã€`node_modules`ã€è‡ªåŠ¨ç”Ÿæˆçš„ `.d.ts` æ–‡ä»¶
- ğŸ“‹ **è§„åˆ™ç­‰çº§**ï¼š
  - `'error'`ï¼šé”™è¯¯ï¼Œä¼šé˜»æ­¢ä»£ç æäº¤ï¼ˆå¦‚æœé…ç½®äº† Git Hookï¼‰
  - `'warn'`ï¼šè­¦å‘Šï¼Œæé†’ä½ æ³¨æ„ä½†ä¸ä¼šé˜»æ­¢æäº¤
  - `'off'`ï¼šå…³é—­è§„åˆ™

## ğŸ› ï¸ å¯ç”¨çš„å‘½ä»¤

æˆ‘åœ¨ `package.json` ä¸­æ·»åŠ äº†ä»¥ä¸‹å‘½ä»¤ï¼š

```bash
# 1. æ£€æŸ¥ä»£ç ï¼ˆåªæŸ¥çœ‹é—®é¢˜ï¼Œä¸ä¿®æ”¹ï¼‰
npm run lint:eslint

# 2. æ£€æŸ¥å¹¶è‡ªåŠ¨ä¿®å¤ä»£ç 
npm run lint:eslint:fix

# 3. æ£€æŸ¥æ‰€æœ‰ä»£ç ï¼ˆESLint + TypeScript + StyleLintï¼‰
npm run lint:all
```

### å‘½ä»¤è¯¦è§£

#### `npm run lint:eslint` - æŸ¥çœ‹æ‰€æœ‰é—®é¢˜

```bash
npm run lint:eslint
```

**è¾“å‡ºç¤ºä¾‹**ï¼š
```
/src/App.vue
  10:5  warning  'count' is never reassigned. Use 'const' instead  prefer-const

/src/utils/api.ts
  5:18  warning  Unexpected any. Specify a different type  @typescript-eslint/no-explicit-any
```

- âœ… **é€‚ç”¨åœºæ™¯**ï¼šæäº¤ä»£ç å‰æ£€æŸ¥ä¸€é
- âœ… **ä¸ä¼šä¿®æ”¹æ–‡ä»¶**ï¼šåªæ˜¯å‘Šè¯‰ä½ æœ‰å“ªäº›é—®é¢˜

#### `npm run lint:eslint:fix` - è‡ªåŠ¨ä¿®å¤é—®é¢˜

```bash
npm run lint:eslint:fix
```

**ä¼šè‡ªåŠ¨ä¿®å¤**ï¼š
- âœ… ç¼©è¿›é—®é¢˜
- âœ… å¤šä½™çš„ç©ºæ ¼
- âœ… ç¼ºå°‘çš„åˆ†å·
- âœ… å•å¼•å·/åŒå¼•å·è½¬æ¢
- âœ… `let` æ”¹æˆ `const`ï¼ˆå¦‚æœå˜é‡æ²¡è¢«é‡æ–°èµ‹å€¼ï¼‰

**ä¸ä¼šè‡ªåŠ¨ä¿®å¤**ï¼ˆéœ€è¦æ‰‹åŠ¨æ”¹ï¼‰ï¼š
- âŒ ä½¿ç”¨äº† `any` ç±»å‹
- âŒ å˜é‡å®šä¹‰ä½†æœªä½¿ç”¨
- âŒ å¤æ‚çš„é€»è¾‘é”™è¯¯

## ğŸ¨ å¸¸è§è§„åˆ™è¯´æ˜

### Vue ç›¸å…³è§„åˆ™

```javascript
// âŒ é”™è¯¯ï¼šç»„ä»¶ååº”è¯¥æ˜¯å¤šä¸ªå•è¯
export default { name: 'App' }

// âœ… æ­£ç¡®ï¼ˆå·²åœ¨é…ç½®ä¸­å…³é—­æ­¤è§„åˆ™ï¼‰
export default { name: 'App' }  // å…è®¸å•è¯ç»„ä»¶å

// âŒ é”™è¯¯ï¼šv-for æ²¡æœ‰ key
<div v-for="item in items">

// âœ… æ­£ç¡®
<div v-for="item in items" :key="item.id">
```

### TypeScript ç›¸å…³è§„åˆ™

```javascript
// âš ï¸ è­¦å‘Šï¼šä½¿ç”¨äº† any ç±»å‹
function getData(param: any) { }

// âœ… æ¨èï¼šæŒ‡å®šå…·ä½“ç±»å‹
function getData(param: string | number) { }

// âœ… æˆ–è€…ä½¿ç”¨æ³›å‹
function getData<T>(param: T) { }

// âš ï¸ è­¦å‘Šï¼šæœªä½¿ç”¨çš„å˜é‡
const unusedVar = 123

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ _ å‰ç¼€è¡¨ç¤ºæ•…æ„ä¸ç”¨
const _unusedVar = 123
```

### JavaScript åŸºç¡€è§„åˆ™

```javascript
// âŒ é”™è¯¯ï¼šä½¿ç”¨ var
var count = 0

// âœ… æ­£ç¡®ï¼šä½¿ç”¨ const æˆ– let
const count = 0

// âš ï¸ è­¦å‘Šï¼šåº”è¯¥ç”¨ const
let name = 'John'  // name æ²¡æœ‰è¢«é‡æ–°èµ‹å€¼

// âœ… æ­£ç¡®
const name = 'John'

// âš ï¸ è­¦å‘Šï¼šåº”è¯¥ç”¨æ¨¡æ¿å­—ç¬¦ä¸²
const greeting = 'Hello ' + name

// âœ… æ­£ç¡®
const greeting = `Hello ${name}`
```

## ğŸ”— Git æäº¤æ—¶è‡ªåŠ¨æ£€æŸ¥

æˆ‘å·²ç»é…ç½®äº† **lint-staged**ï¼Œç°åœ¨å½“ä½  `git commit` æ—¶ï¼š

1. âœ… è‡ªåŠ¨è¿è¡Œ ESLint ä¿®å¤ä»£ç æ ¼å¼
2. âœ… è¿è¡Œ TypeScript ç±»å‹æ£€æŸ¥
3. âœ… è¿è¡Œ StyleLint æ£€æŸ¥æ ·å¼
4. âŒ å¦‚æœæœ‰é”™è¯¯ï¼Œæäº¤ä¼šè¢«é˜»æ­¢

**å·¥ä½œæµç¨‹**ï¼š
```bash
git add .
git commit -m "feat: æ·»åŠ æ–°åŠŸèƒ½"

# è‡ªåŠ¨æ‰§è¡Œï¼š
# â†’ ESLint ä¿®å¤ä»£ç é£æ ¼
# â†’ TypeScript æ£€æŸ¥ç±»å‹
# â†’ StyleLint æ£€æŸ¥æ ·å¼
# â†’ å…¨éƒ¨é€šè¿‡åæ‰å…è®¸æäº¤
```

## ğŸ¯ å®é™…ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1ï¼šå¼€å‘æ—¶è¾¹å†™è¾¹æ£€æŸ¥

**VS Code ç”¨æˆ·**ï¼š
1. å®‰è£… ESLint æ’ä»¶
2. æ–‡ä»¶ä¿å­˜æ—¶è‡ªåŠ¨æ˜¾ç¤ºé”™è¯¯æç¤º
3. é¼ æ ‡æ‚¬åœçœ‹åˆ°è¯¦ç»†è¯´æ˜

### åœºæ™¯ 2ï¼šæäº¤å‰å…¨é¢æ£€æŸ¥

```bash
# æ£€æŸ¥æ‰€æœ‰ä»£ç 
npm run lint:all

# å¦‚æœæœ‰é—®é¢˜ï¼Œå…ˆè‡ªåŠ¨ä¿®å¤
npm run lint:eslint:fix

# å†æ£€æŸ¥ä¸€æ¬¡
npm run lint:all

# é€šè¿‡åæäº¤
git commit -m "fix: ä¿®å¤ç™»å½•é—®é¢˜"
```

### åœºæ™¯ 3ï¼šä¿®å¤ç‰¹å®šæ–‡ä»¶

```bash
# åªä¿®å¤æŸä¸ªæ–‡ä»¶
npx eslint src/views/chat/index.vue --fix

# åªä¿®å¤æŸä¸ªç›®å½•
npx eslint src/components/ --fix
```

## ğŸ“Š å½“å‰ä»£ç çŠ¶æ€

è¿è¡Œ `npm run lint:eslint:fix` åï¼Œè‡ªåŠ¨ä¿®å¤äº† **50 ä¸ªé—®é¢˜**ï¼

**å‰©ä½™é—®é¢˜**ï¼š
- 3 ä¸ªé”™è¯¯ï¼ˆéœ€è¦æ‰‹åŠ¨ä¿®å¤ï¼‰
- 9 ä¸ªè­¦å‘Šï¼ˆå¯ä»¥æš‚æ—¶å¿½ç•¥ï¼‰

**ä¸»è¦é—®é¢˜**ï¼š
1. `@ts-ignore` åº”è¯¥æ”¹æˆ `@ts-expect-error`
2. ä¸€äº›åœ°æ–¹ä½¿ç”¨äº† `any` ç±»å‹
3. å®šä¹‰äº†ä½†æ²¡ä½¿ç”¨çš„å˜é‡

## ğŸ“ å­¦ä¹ å»ºè®®

### å¯¹äºåˆå­¦è€…ï¼š

1. **ä¸è¦è¢«è­¦å‘Šå“åˆ°**ï¼šè­¦å‘Šä¸ä¼šé˜»æ­¢ä»£ç è¿è¡Œï¼Œåªæ˜¯å»ºè®®
2. **å…ˆä¿®å¤é”™è¯¯**ï¼šå…ˆå…³æ³¨çº¢è‰²çš„ `error`ï¼Œå†çœ‹é»„è‰²çš„ `warning`
3. **ç†è§£è§„åˆ™åŸå› **ï¼šæ¯ä¸ªè§„åˆ™éƒ½æœ‰å…¶åŸå› ï¼Œé¼ æ ‡æ‚¬åœå¯ä»¥çœ‹åˆ°è¯´æ˜
4. **å¾ªåºæ¸è¿›**ï¼šä¸éœ€è¦ä¸€æ¬¡æ€§ä¿®å¤æ‰€æœ‰é—®é¢˜

### å¸¸ç”¨æŠ€å·§ï¼š

```javascript
// ä¸´æ—¶ç¦ç”¨æŸä¸€è¡Œçš„æ£€æŸ¥
// eslint-disable-next-line no-console
console.log('è°ƒè¯•ä¿¡æ¯')

// ç¦ç”¨æ•´ä¸ªæ–‡ä»¶çš„æŸä¸ªè§„åˆ™
/* eslint-disable no-console */
console.log('è¿™ä¸ªæ–‡ä»¶å¯ä»¥ç”¨ console')

// ç¦ç”¨æ•´ä¸ªæ–‡ä»¶çš„æ‰€æœ‰è§„åˆ™ï¼ˆä¸æ¨èï¼‰
/* eslint-disable */
```

## ğŸ”§ è‡ªå®šä¹‰é…ç½®

å¦‚æœä½ è§‰å¾—æŸä¸ªè§„åˆ™å¤ªä¸¥æ ¼ï¼Œå¯ä»¥åœ¨ `eslint.config.js` ä¸­è°ƒæ•´ï¼š

```javascript
rules: {
  // å°†é”™è¯¯æ”¹æˆè­¦å‘Š
  '@typescript-eslint/no-explicit-any': 'warn',  // åŸæ¥æ˜¯ error
  
  // å®Œå…¨å…³é—­è§„åˆ™
  'no-console': 'off',
  
  // è‡ªå®šä¹‰è§„åˆ™å‚æ•°
  'vue/max-attributes-per-line': ['warn', {
    singleline: 5,  // å•è¡Œæœ€å¤š 5 ä¸ªå±æ€§ï¼ˆåŸæ¥æ˜¯ 3ï¼‰
    multiline: 1,
  }],
}
```

## ğŸ“š å¸¸è§é—®é¢˜

### Q1: ESLint å’Œ TypeScript æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**TypeScript**ï¼š
- âœ… æ£€æŸ¥ç±»å‹é”™è¯¯ï¼ˆå¦‚æŠŠå­—ç¬¦ä¸²ä¼ ç»™æ•°å­—å‚æ•°ï¼‰
- âœ… åœ¨ç¼–è¯‘æ—¶å‘ç°ç±»å‹é—®é¢˜

**ESLint**ï¼š
- âœ… æ£€æŸ¥ä»£ç é£æ ¼å’Œæœ€ä½³å®è·µ
- âœ… å‘ç°é€»è¾‘é”™è¯¯å’Œä¸è§„èŒƒå†™æ³•
- âœ… å¯ä»¥è‡ªåŠ¨ä¿®å¤æ ¼å¼é—®é¢˜

**ç»“è®º**ï¼šä¸¤è€…äº’è¡¥ï¼Œéƒ½éœ€è¦ï¼

### Q2: ä¸ºä»€ä¹ˆæœ‰äº›è§„åˆ™å¾ˆçƒ¦äººï¼Ÿ

è§„åˆ™å­˜åœ¨éƒ½æœ‰åŸå› ï¼š
- `prefer-const`ï¼šé˜²æ­¢æ„å¤–ä¿®æ”¹ä¸è¯¥æ”¹çš„å˜é‡
- `no-unused-vars`ï¼šé¿å…ä»£ç ä¸­ç•™ä¸‹åƒåœ¾å˜é‡
- `@typescript-eslint/no-explicit-any`ï¼šä¿è¯ç±»å‹å®‰å…¨

### Q3: å¯ä»¥ç¦ç”¨æ‰€æœ‰è§„åˆ™å—ï¼Ÿ

âŒ **ä¸æ¨è**ï¼ESLint æ˜¯ä½ çš„ä»£ç åŠ©æ‰‹ï¼Œä¸æ˜¯æ•Œäººã€‚

å¦‚æœç¡®å®éœ€è¦ï¼š
```javascript
// eslint.config.js
export default [
  // ... å…¶ä»–é…ç½®
  {
    rules: {
      // å…³é—­æ‰€æœ‰è§„åˆ™ï¼ˆéå¸¸ä¸æ¨èï¼‰
      ...Object.keys(rules).reduce((acc, rule) => {
        acc[rule] = 'off'
        return acc
      }, {})
    }
  }
]
```

## ğŸ‰ æ€»ç»“

ç°åœ¨ä½ çš„é¡¹ç›®å·²ç»é…ç½®å¥½äº† ESLintï¼š

- âœ… **å®‰è£…å®Œæˆ**ï¼šæ‰€æœ‰ä¾èµ–å·²å®‰è£…
- âœ… **é…ç½®å®Œæˆ**ï¼šé…ç½®æ–‡ä»¶å·²åˆ›å»º
- âœ… **è‡ªåŠ¨ä¿®å¤**ï¼šæäº¤ä»£ç æ—¶è‡ªåŠ¨æ£€æŸ¥
- âœ… **å›¢é˜Ÿåä½œ**ï¼šæ‰€æœ‰äººéµå¾ªåŒæ ·çš„ä»£ç è§„èŒƒ

**ä¸‹ä¸€æ­¥**ï¼š
1. åœ¨ç¼–è¾‘å™¨ä¸­å®‰è£… ESLint æ’ä»¶
2. å¼€å‘æ—¶æ³¨æ„ ESLint çš„æç¤º
3. æäº¤å‰è¿è¡Œ `npm run lint:eslint:fix`

æœ‰ä»»ä½•é—®é¢˜éšæ—¶é—®æˆ‘ï¼ğŸš€
